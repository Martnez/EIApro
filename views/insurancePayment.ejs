<%- include ('./includes/header.ejs') %>
  <body>
    <div class="dash-container">
      <div class="hover-hamburger" id="hover_hamburger">
        <div class="inner-hamburger">
          <div class="bar"></div>
          <div class="bar"></div>
          <div class="bar"></div>
        </div>
      </div>
      <div class="nav-overlay" id="overlay"></div>
      <div class="side-bar" id="side_bar">
        <div class="other-hover-hamburger show" id="other_hover_hamburger">
          <div class="inner-hamburger">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
          </div>
        </div>
        <div class="side-bar-content">
          <div class="top-image-holder dash-img">
            <img src="/images/eia_logo.png" alt="" />
          </div>
          <ul class="links">
            <li class="list">
              <a href="/dashboard" class="link">Home</a>
            </li>
            <li class="list">
              <a href="/clients" class="link">Clients</a>
            </li>
            <li class="list">
              <a href="/underwriting" class="link active">Underwriting</a>
            </li>
            <li class="list">
              <a href="/claims" class="link">Claims</a>
            </li>
            <li class="list">
              <a href="/vehicles" class="link">Vehicles</a>
            </li>
            <li class="list">
              <a href="" class="link">Credit</a>
            </li>
            <li class="list">
              <a href="" class="link">Reports</a>
            </li>
          </ul>
          <ul class="links lower">
            <li class="list">
              <a href="/admin" class="link">Admin</a>
            </li>
            <li class="list">
              <a href="/logout" class="link logout">Logout</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="top-bar">
        <div class="user-name-space">
          <div class="user-icon">
            <div class="image-holder">
              <img src=" /images/user-img.png" alt="" />
            </div>
            <h3 class="username-dash">Hello <%= user.firstName %> </h3>
          </div>
        </div>
      </div>
      <div class="time-bar">
        <h3 id="date_value"></h3>
      </div>
      <div class="dash-main">
        <div class="dash-content">
          <div class="client-profile-content">
            <div class="details-display">
              <div class="top-nav-options">
                <a href="/policyView/<%=policyId%>" class="nav-options-link">Policy Details</a>
                <a href="http://192.168.0.34/EIApro/php_files/policy-documents.php?id=<%=
                policyId %>&username=<%= user.firstName %>" class="nav-options-link">Image Documents</a>
                <a href="/credit/<%=policyId %>" class="nav-options-link">Credit Collection</a>
                <a href="/insurancePay/<%=policyId %>" class="nav-options-link active">Insurance Payment</a>
              </div>
              <div class="display-panel">
                <h2 class="data-input-title"><%= firstName %> <%=lastName %></h2>
                <div class="rows">
                  <div class="data-col">
                    <h2 class="title" style="padding: 0 0 0 1rem ;">Payments Calculations</h2>                      
                      <input
                      type="number"
                      required
                      id="basic_prem"
                      disabled
                      value="<%= basicPremium %>"
                      name=""
                      class="input-space"
                      style="display: none;"
                    />
                      <input
                      type="text"
                      required
                      id="PHCF"
                      disabled
                      value="<%= PHCF %>"
                      name=""
                      class="input-space"
                      style="display: none;"
                    />
                      <input
                      type="text"
                      required
                      id="levy"
                      disabled
                      value="<%= levy %>"
                      name=""
                      class="input-space"
                      style="display: none;"
                    />
                      <input
                      type="text"
                      required
                      id="stampDuty"
                      disabled
                      value="<%= stampDuty %>"
                      name=""
                      class="input-space"
                      style="display: none;"
                    />
                      <form action="/insurancePay/<%= policyId %>" method="post" class="form-action">
                        <div class="input-holder inside">
                          <input
                            type="text"
                            placeholder="Comm. Rate"
                            onkeyup="calc_rate(<%= basicPremium %>)"
                            required
                            id="com_rate"
                            name="comm_rate"
                            value="<%= comm_rate %>"
                            style="max-width: 200px;"
                            class="input-space"
                          />
                        </div>
                        <div class="input-holder inside">
                          <input
                            type="text"
                            placeholder="Comm. Amount(Kshs)"
                            required
                            id="com_amount"
                            disabled
                            style="background-color: #d4d4d4;max-width: 200px;"
                            name=""
                            class="input-space"
                          />
                          <input
                            type="text"
                            placeholder="Comm. Amount(poa)"
                            required
                            id="com_amount_poa"
                            style="display: none;"
                            name="comm_amount"
                            class="input-space"
                          />
                        </div>
                        <div class="input-holder inside">
                          <input
                            type="text"
                            placeholder="Ovr. Rate"
                            onkeyup="calc_ovr(<%= basicPremium %>)"
                            required
                            value="<%= ovr_rate %>"
                            id="overide_rate"
                            style="max-width: 200px;"
                            name="ovr_rate"
                            class="input-space"
                          />
                        </div>
                        <div class="input-holder inside">
                          <input
                            type="text"
                            placeholder="Ovr Amount (Kshs)"
                            disabled
                            id="overide_amount"
                            style="background-color: #d4d4d4;max-width: 200px;"
                            required
                            name="ovr_rate"
                            class="input-space"
                          />
                          <input
                            type="text"
                            placeholder="Ovr Amount (poa)"
                            id="overide_amount_poa"
                            style="display: none;"
                            required
                            name="ovr_amount"
                            class="input-space"
                          />
                        </div>
                        <div class="input-holder inside">
                          <input
                            type="text"
                            placeholder="Special Discount"
                            onkeyup="special_discs(<%= basicPremium %>)"
                            required
                            value="<%= special_disc %>"
                            style="max-width: 200px;"
                            id="special_discount"
                            name=""
                            class="input-space"
                          />
                          <input
                            type="text"
                            placeholder="Special Discount(Poa)"
                            required
                            id="special_discount_poa"
                            style="display: none;"
                            name="special_disc"
                            class="input-space"
                          />
                        </div>
                        <div class="input-holder inside">
                          <input
                            type="text"
                            placeholder="Net Premium(Kshs)"
                            required
                            id="net_premium"
                            disabled
                            name=""
                            class="input-space"
                            style="background-color: #d4d4d4;max-width: 200px;"
                          />
                          <input
                            type="text"
                            placeholder="Net Premium(Poa)"
                            required
                            id="net_premium_poa"
                            disabled
                            name=""
                            class="input-space"
                            style="display: none;"
                          />
                        </div>
                        <div class="input-holder inside">
                          <input
                            type="text"
                            placeholder="Payment Due(Kshs)"
                            required
                            id="payment_due"
                            disabled
                            style="background-color: #d4d4d4;max-width: 200px;"
                            name=""
                            class="input-space"
                          />
                          <input
                            type="number"
                            placeholder="Payment Due(Poa)"
                            required
                            id="payment_due_poa"
                            disabled
                            style="display: none;"
                            name=""
                            class="input-space"
                          />
                        </div>
                        <div class="button-holder" style="margin-left: 2rem">
                          <button name="" class="btn add-new">Update</button>
                        </div>
                    </form>
                    </div>
                    <div class="data-col" style="background-color: #ebebeb;height: fit-content;margin: 1rem; padding: 1rem;border-radius: 0.5rem;">
                      <h2 class="title" style="padding: 0 0 0 1rem;">Payment Section</h2>
                      <form action="/creditPay/<%= policyId %>" method="post" class="form-action">
                        <div class="input-holder inside">
                          <input
                            type="text"
                            placeholder="Amount (Kshs)"
                            required
                            name="p_paid"
                            class="input-space"
                          />
                        </div>
                        <div class="input-holder split">
                          <input
                            type="text"
                            placeholder="Date Paid"
                            onblur="(this.type='text')"
                            onfocus="(this. type='date')"
                            id="end_date"
                            required
                            name="p_date"
                            class="input-space"
                          />
                        </div>
                        <div class="input-holder inside">
                          <select
                            name="p_mode"
                            class="input-space"
                            required
                          >
                            <option value="" selected>Select Payment Mode</option>
                            <option value="Cash">Cash</option>
                            <option value="M-Pesa">M-Pesa</option>
                            <option value="Bank Trasfer">Bank Trasfer</option>
                          </select>
                        </div>
                        <div class="input-holder inside">
                          <input
                            type="text"
                            placeholder="Ref Number"
                            required
                            name="refNumber"
                            class="input-space"
                          />
                        </div>
                        <div class="button-holder" style="margin-left: 1rem;display: flex;justify-content: center;">
                          <button name="" class="btn">Make Payment</button>
                        </div>
                    </form>
                    </div>
                  
                <div class="rows">
                  <div class="data-col">
                    <div class="dash-table-display">
                      <table class="info-list-table">
                        <thead>
                          <tr>
                            <th>Date Paid</th>
                            <th>Amount Paid</th>
                            <th>Mode</th>
                            <th>Reference No.</th>
                            <th>Paiment Doc</th>
                          </tr>
                        </thead>
                        <tbody id="myTable">
                            <% if(creditPay.length > 0) {%>
                                <% for(let singleCredit of creditPay){%>
                                    <tr>
                                      <td><%=singleCredit.p_date  %>  </td>
                                      <td><%=singleCredit.p_paid %> </td>
                                      <td><%=singleCredit.p_mode  %> </td>
                                      <td><%=singleCredit.refNumber %> </td>
                                      <td><a href="">./mpesa/receipt0809.pdf</a></td>
                                    </tr> 
                                     <% } %> 
                                <% }else{%><% } %>      
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="/js/insurance_calc.js"></script>
    <script src="/js/time.js"></script>
    <script src="/js/nav.js"></script>
  </body>
</html>
